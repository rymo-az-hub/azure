# Day 4 Progress (2026-02-07)

## ä»Šæ—¥ã®çµè«E- **æ–¹é‡ãE A ã§é€²ã‚ã‚‹**EEhat-if çµæœã‚’è¦‹ã¦ã€æƒ³å®šå¤–ãEå¤§ããªå·®åˆEŒãªãE“ã¨ã‚’ç¢ºèªã§ããŸãŸã‚EE- ä»Šæ—¥ã¯ã“ã“ã§ä¸€æ—¦åŒºåˆE‚ŠEˆã‚³ãƒŸãƒƒãƒEPush ã¾ã§å®ŒäºE¼E
---

## ä»Šæ—¥ã‚E£ãŸã“ã¨Eˆã‚µãƒãƒªEE### 1) Repoæ•´çE¼Enfra/kv å†ç·¨EE- `infra/kv` é…ä¸‹ã‚’ **baseline-v1 ã‚’æ­£æœ¬**ã«çµ±ä¸€
- æ—§æ§‹æEEEpe-v1` / `rbac-v2` / æ—§ keyvaultE‰ãE `infra/kv/_legacy/` ã«é›E´E- `infra/kv/README.md` ã‚’è¿½åŠ ã—ã€å°ç·šã‚’æ•´çE- è¿½åŠ ã•ã‚ŒãŸæ§‹æEEˆæœ€çµ‚çŠ¶æ…‹ï¼E  - `infra/kv/baseline-v1/`EEodules: keyvault / privateDns / privateEndpoint / diagnostics / rbacEE
### 2) Docsæ›´æ–°EEvidence / é€²æE/ ã‚³ãƒãƒ³ãƒ‰ãƒ­ã‚° / ADREE- Evidence ã‚’æ›´æ–°EEv RBAC v2EE- é€²æ—ãƒ­ã‚°ã¨ã‚³ãƒãƒ³ãƒ‰ãƒ­ã‚°ã‚’æ›´æ–°
- ADR ã‚’è¿½åŠ EEV RBAC v2 ã®æœ€å°æ¨©é™ãEä¸»ä½“åEé›¢EE
### 3) Gité‹ç”¨EERLF/LFã§è©°ã¾ã£ãŸç‚¹ã®è§£æ¶ˆï¼E- `git add` æ™‚ã« **CRLF â†ELF ç½®æ›ãŒç™ºç”Ÿã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«**ãŒã‚ã‚Šã€staging ãŒæ­¢ã¾ã£ãE- PowerShell ã§ **CRLFâ†’LF æ­£è¦åŒ–**ã—ã¦ã‹ã‚‰ addEEEADMEç³»EE
---

## Azureå´ã®ç¢ºèªï¼Ehat-ifEEå®Ÿæ–½ã‚³ãƒãƒ³ãƒ‰ï¼ˆä¾‹ï¼E
- `az deployment group what-if -g $rg -f $f -p @$p`

what-if ã®ä¸»ãªå·®åˆE¼ˆèª­ã¿å–ã‚ŠEE
- **å¤‰æ›´ã¯ 2 ä»¶ã®ã¿EEodifyEE*
  1) Diagnostic settings: `AzurePolicyEvaluationDetails` ã® logs è¨­å®šå‘¨ã‚Šï¼ˆãƒã‚¤ã‚ºå«ã‚€EE  2) Private Endpoint ã® `privateDnsZoneGroups` ã® `privateDnsZoneConfigs` è¡¨ç¤ºå·®åˆE¼Etag / provisioningState / type ãªã©ã® **ãƒã‚¤ã‚º**EE
---

## åˆ¤æ–­çE”±EEã§ãEæ ¹æ‹ EE- what-if ã®å·®åˆEŒ **æ„å›³ã—ãŸæ§‹æEEEaseline-v1E‰ã«æ²¿ãE¯E›²**ã§ã€ç ´å£Šçš„å¤‰æ›´ãŒãªãE- `privateDnsZoneGroups` ã®å·®åˆEE ARM ã® **èª­ã¿å–ã‚Šå·®Eˆãƒã‚¤ã‚ºEE*ãŒä¸»ã§ã€è³E”£ã®å†ä½œæEã‚E§‹æEç ´ç¶»ã®å…E€™ãªãE- Diag å‘¨ã‚Šã‚‚ â€œå‹æ‰‹ã«å¤§é‡å¤‰æ›´â€Eã§ã¯ãªãã€ã‚«ãƒE‚´ãƒªè¨­å®šå·®åˆEEç¯E›²

---

## æ¬¡å›ã‚„ã‚‹ã“ã¨EˆåEä½“ï¼E1) baseline-v1 ã‚’å®Ÿãƒ‡ãƒ—ãƒ­ã‚¤EEhatIf â†EDeployEE2) Deployå¾ŒãE Evidence ã‚’è¿½åŠ 
   - KV æœ¬ä½“è¨­å®šï¼Eoft delete / purge protection / public network access / firewall / RBAC / purgeä¿è­·EE   - PE / DNSEˆç–é€šã€åå‰è§£æ±ºã€NIC/PEã‚µãƒ–ãƒªã‚½ãƒ¼ã‚¹EE   - Diagnostic settingsEEAWåˆ°é”ãEã‚«ãƒE‚´ãƒªEE3) `main.parameters.json` ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¦¥å½“æ€§EEBACä¸»ä½“ãEã‚¿ã‚°E‰ã‚’æœ€çµ‚ç¢ºèªã—ã¦å›ºå®E
---

## ãƒ¡ãƒ¢
- parametersEˆä¾‹ï¼E  - `location`: japaneast
  - `keyVaultName`: kv-plat-dev-45bddcd7-001
  - `logAnalyticsWorkspaceId`: law-platform-baseline
  - `vnetId` / `privateEndpointSubnetId`: vnet-platform-baseline / snet-privatelink
  - RBAC: `secretsOfficers` / `secretsUsers` ã‚EGUID ã§æŒE®E